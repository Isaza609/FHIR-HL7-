# Requisitos del Sistema de Interoperabilidad de Agendas – ACME Salud

---

## 1. Requisitos Funcionales

Los siguientes requisitos describen el comportamiento que debe cumplir el sistema de interoperabilidad de agendas de ACME Salud.

---

### RF-01 – Gestión de sedes
El sistema debe permitir registrar las tres sedes de ACME Salud como recursos **Location**, asociados a la organización principal.

---

### RF-02 – Gestión de servicios
El sistema debe permitir registrar los servicios médicos ofrecidos en cada sede como recursos **HealthcareService**.

Cada servicio debe estar asociado a:
- Una **Location**
- La **Organization ACME Salud**

---

### RF-03 – Gestión de profesionales
El sistema debe permitir registrar médicos como recursos **Practitioner**, incluyendo su tarjeta profesional.

Debe asociarse cada médico a la institución mediante **PractitionerRole**, indicando:
- Organización
- Sede
- Servicio que presta

---

### RF-04 – Gestión de aseguradoras y cobertura
El sistema debe permitir registrar aseguradoras como recursos **Organization**.

Debe permitir relacionar un paciente con su aseguradora mediante el recurso **Coverage**.

---

### RF-05 – Gestión de agendas
El sistema debe permitir:

Crear agendas mensuales (**Schedule**) para:
- Cada **HealthcareService**
- Cada **PractitionerRole**

Definir intervalos de tiempo disponibles mediante recursos **Slot**.

---

### RF-06 – Consulta de disponibilidad
El sistema debe permitir consultar los **Slot** disponibles según:
- Sede
- Servicio
- Profesional
- Tipo de consulta

---

### RF-07 – Agendamiento de cita
Cuando un paciente solicite una cita:

- El sistema debe crear un recurso **Appointment**
- Debe asociarlo al **Slot** correspondiente
- Debe cambiar el estado del Slot a `busy`
- Debe generar un recurso **AppointmentResponse** como confirmación

---

### RF-08 – Cancelación de cita
El sistema debe permitir cancelar una cita:

- Cambiando `Appointment.status` a `cancelled`
- Registrando `Appointment.cancellationReason`
- Liberando el Slot correspondiente (`status = free`)

---

### RF-09 – Determinación de duración de cita
El sistema debe determinar la duración del Slot según:
- Tipo de consulta
- Aseguradora del paciente (**Coverage**)

De acuerdo con la tabla establecida en el escenario.

---

## 2. Requisitos No Funcionales

---

### RNF-01 – Interoperabilidad
El sistema debe estar basado en el estándar **HL7 FHIR R4**, utilizando recursos oficiales definidos por la especificación.

---

### RNF-02 – Centralización
El servidor FHIR debe actuar como repositorio central para todas las solicitudes provenientes de los distintos canales.

---

### RNF-03 – Consistencia de datos
El sistema debe garantizar que:
- Un Slot no pueda estar asociado a más de un Appointment activo
- No existan conflictos de agenda

---

### RNF-04 – Integridad de información
Los estados de los recursos deben mantenerse coherentes:
- `Slot.status` debe reflejar el estado real
- `Appointment.status` debe actualizarse correctamente ante cancelación

---

### RNF-05 – Trazabilidad
Cada **Appointment** debe poder identificarse de manera única mediante su `id`.

---

### RNF-06 – Disponibilidad conceptual
El modelo debe permitir integración con múltiples canales:
- Web
- App
- Call Center
- HIS

Sin alterar la estructura central de datos.