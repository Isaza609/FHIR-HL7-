{
  "info": {
    "name": "ACME Salud - FHIR R4",
    "description": "Peticiones al servidor HAPI FHIR público (baseR4) para el proyecto de interoperabilidad de agendas ACME Salud.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://hapi.fhir.org/baseR4"
    }
  ],
  "item": [
    {
      "name": "Metadatos",
      "item": [
        {
          "name": "GET CapabilityStatement (metadata)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" }
            ],
            "url": "{{baseUrl}}/metadata",
            "description": "Verifica que el servidor R4 responde y muestra capacidades."
          }
        }
      ]
    },
    {
      "name": "Organization",
      "item": [
        {
          "name": "GET Organization por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Organization/org-acme-salud",
            "description": "Obtiene ACME Salud."
          }
        },
        {
          "name": "GET Buscar Organizations",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Organization?name=ACME",
            "description": "Busca organizaciones por nombre."
          }
        },
        {
          "name": "GET Solo ACME (por id)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Organization?_id=org-acme-salud",
            "description": "Solo nuestra organización en servidor público."
          }
        }
      ]
    },
    {
      "name": "Location",
      "item": [
        {
          "name": "GET Location por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Location/loc-norte",
            "description": "Obtiene una sede (ej. Norte). Cambiar id: loc-centro, loc-sur."
          }
        },
        {
          "name": "GET Nuestras Location (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Location?_id=loc-norte,loc-centro,loc-sur",
            "description": "Solo las 3 sedes de ACME. En servidor público filtrar por _id."
          }
        }
      ]
    },
    {
      "name": "HealthcareService",
      "item": [
        {
          "name": "GET HealthcareService por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/HealthcareService/hs-pediatria-norte",
            "description": "Obtiene un servicio (ej. Pediatría Norte)."
          }
        },
        {
          "name": "GET Buscar por Location",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/HealthcareService?location=Location/loc-norte",
            "description": "Servicios de la sede Norte."
          }
        },
        {
          "name": "GET Nuestros HealthcareService (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/HealthcareService?location=Location/loc-norte&location=Location/loc-centro&location=Location/loc-sur",
            "description": "Solo servicios de nuestras 3 sedes."
          }
        }
      ]
    },
    {
      "name": "Practitioner",
      "item": [
        {
          "name": "GET Practitioner por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Practitioner/prac-gregorio-casas",
            "description": "Obtiene un médico por id."
          }
        },
        {
          "name": "GET Nuestros Practitioner (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Practitioner?_id=prac-gregorio-casas,prac-elmer-luna,prac-luis-manuel-chavez,prac-alvaro-silva,prac-diego-narvaez,prac-alonso-fonseca",
            "description": "Solo los 6 médicos de ACME."
          }
        }
      ]
    },
    {
      "name": "PractitionerRole",
      "item": [
        {
          "name": "GET PractitionerRole por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/PractitionerRole/pr-casas-pediatria-norte",
            "description": "Rol del médico en la institución."
          }
        },
        {
          "name": "GET Nuestros PractitionerRole (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/PractitionerRole?organization=Organization/org-acme-salud",
            "description": "Solo roles de ACME (filtro por organización)."
          }
        }
      ]
    },
    {
      "name": "Patient",
      "item": [
        {
          "name": "GET Patient por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Patient/pat-ejemplo-001",
            "description": "Obtiene un paciente."
          }
        },
        {
          "name": "GET Nuestros Patient (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Patient?_id=pat-ejemplo-001,pat-ejemplo-002",
            "description": "Pacientes de ejemplo ACME."
          }
        }
      ]
    },
    {
      "name": "Coverage",
      "item": [
        {
          "name": "GET Coverage por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Coverage/cov-001",
            "description": "Cobertura del paciente (aseguradora)."
          }
        },
        {
          "name": "GET Nuestros Coverage (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Coverage?_id=cov-001,cov-002",
            "description": "Solo coberturas de ejemplo ACME."
          }
        }
      ]
    },
    {
      "name": "Schedule",
      "item": [
        {
          "name": "GET Schedule por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Schedule/sched-pr-casas-2025-02",
            "description": "Agenda mensual (por servicio o por médico)."
          }
        },
        {
          "name": "GET Nuestros Schedule (solo ACME)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Schedule?_id=sched-hs-pediatria-2025-02,sched-pr-casas-2025-02",
            "description": "Solo agendas ACME. Añadir más _id si creas más Schedules."
          }
        }
      ]
    },
    {
      "name": "Slot",
      "item": [
        {
          "name": "GET Slots libres (solo nuestros)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Slot?schedule=Schedule/sched-hs-pediatria-2025-02&schedule=Schedule/sched-pr-casas-2025-02&status=free",
            "description": "RF-06: slots libres solo de agendas ACME. En servidor público SIEMPRE filtrar por schedule."
          }
        },
        {
          "name": "GET Slots por un Schedule",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Slot?schedule=Schedule/sched-pr-casas-2025-02&status=free",
            "description": "Slots libres de una agenda concreta."
          }
        },
        {
          "name": "PUT Slot a busy (marcar ocupado)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Slot\",\n  \"id\": \"slot-pediatria-001\",\n  \"meta\": { \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Slot\"] },\n  \"schedule\": { \"reference\": \"Schedule/sched-pr-casas-2025-02\" },\n  \"status\": \"busy\",\n  \"start\": \"2025-02-19T08:00:00-05:00\",\n  \"end\": \"2025-02-19T08:30:00-05:00\"\n}"
            },
            "url": "{{baseUrl}}/Slot/slot-pediatria-001",
            "description": "Marca el slot como ocupado (status=busy). Ejecutar después de crear la cita (PUT Appointment). Cambiar id y start/end si usas otro slot."
          }
        },
        {
          "name": "PUT Slot a free (liberar slot)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Slot\",\n  \"id\": \"slot-pediatria-001\",\n  \"meta\": { \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Slot\"] },\n  \"schedule\": { \"reference\": \"Schedule/sched-pr-casas-2025-02\" },\n  \"status\": \"free\",\n  \"start\": \"2025-02-19T08:00:00-05:00\",\n  \"end\": \"2025-02-19T08:30:00-05:00\"\n}"
            },
            "url": "{{baseUrl}}/Slot/slot-pediatria-001",
            "description": "Libera el slot (status=free). Ejecutar después de cancelar la cita (PUT Cancelar cita). Así el slot vuelve a aparecer en GET Slots libres."
          }
        }
      ]
    },
    {
      "name": "Appointment",
      "item": [
        {
          "name": "GET Appointment por id",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Appointment/appt-ejemplo",
            "description": "Obtiene una cita."
          }
        },
        {
          "name": "GET Nuestras citas (solo ACME por sede)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Appointment?status=booked&location=Location/loc-norte&location=Location/loc-centro&location=Location/loc-sur",
            "description": "Citas activas solo en nuestras 3 sedes. En servidor público usar este filtro."
          }
        },
        {
          "name": "GET Buscar Appointments (evitar en público)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Accept", "value": "application/fhir+json" }],
            "url": "{{baseUrl}}/Appointment?status=booked",
            "description": "Sin filtro; en servidor público preferir 'Nuestras citas'."
          }
        },
        {
          "name": "PUT Crear cita (Appointment)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Appointment\",\n  \"id\": \"appt-ejemplo\",\n  \"meta\": { \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Appointment\"] },\n  \"status\": \"booked\",\n  \"start\": \"2025-02-19T08:00:00-05:00\",\n  \"end\": \"2025-02-19T08:30:00-05:00\",\n  \"slot\": [{ \"reference\": \"Slot/slot-pediatria-001\" }],\n  \"serviceType\": [{ \"coding\": [{ \"system\": \"http://terminology.hl7.org/CodeSystem/service-type\", \"code\": \"57\", \"display\": \"Control - Pediatría\" }] }],\n  \"participant\": [\n    { \"actor\": { \"reference\": \"Patient/pat-ejemplo-001\" }, \"required\": \"required\", \"status\": \"accepted\" },\n    { \"actor\": { \"reference\": \"PractitionerRole/pr-casas-pediatria-norte\" }, \"required\": \"required\", \"status\": \"accepted\" }\n  ]\n}"
            },
            "url": "{{baseUrl}}/Appointment/appt-ejemplo",
            "description": "Crea una cita (Appointment). Referencia Slot, Patient y PractitionerRole. Después ejecutar 'PUT Slot a busy' para el slot referenciado (ej. slot-pediatria-001). Cuerpo desde fhir_resources/Appointment/appt-ejemplo.json."
          }
        },
        {
          "name": "PUT Cancelar cita (Appointment)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Appointment\",\n  \"id\": \"appt-ejemplo\",\n  \"meta\": { \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Appointment\"] },\n  \"status\": \"cancelled\",\n  \"cancelationReason\": {\n    \"coding\": [{ \"system\": \"http://terminology.hl7.org/CodeSystem/appointment-cancellation-reason\", \"code\": \"pat\", \"display\": \"Patient\" }]\n  },\n  \"start\": \"2025-02-19T08:00:00-05:00\",\n  \"end\": \"2025-02-19T08:30:00-05:00\",\n  \"slot\": [{ \"reference\": \"Slot/slot-pediatria-001\" }],\n  \"serviceType\": [{ \"coding\": [{ \"system\": \"http://terminology.hl7.org/CodeSystem/service-type\", \"code\": \"57\", \"display\": \"Control - Pediatría\" }] }],\n  \"participant\": [\n    { \"actor\": { \"reference\": \"Patient/pat-ejemplo-001\" }, \"required\": \"required\", \"status\": \"accepted\" },\n    { \"actor\": { \"reference\": \"PractitionerRole/pr-casas-pediatria-norte\" }, \"required\": \"required\", \"status\": \"accepted\" }\n  ]\n}"
            },
            "url": "{{baseUrl}}/Appointment/appt-ejemplo",
            "description": "Cancela la cita (status=cancelled, cancelationReason). Después ejecutar 'PUT Slot a free' para el slot referenciado y que vuelva a estar disponible. Cuerpo desde fhir_resources/Appointment/appt-ejemplo-cancelado.json."
          }
        }
      ]
    },
    {
      "name": "Cargar recursos (PUT)",
      "item": [
        {
          "name": "PUT Organization",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Organization\",\n  \"id\": \"org-acme-salud\",\n  \"identifier\": [{ \"system\": \"http://www.minsalud.gov.co/NIT\", \"value\": \"900123456-1\" }],\n  \"name\": \"ACME Salud\",\n  \"type\": [{ \"coding\": [{ \"system\": \"http://terminology.hl7.org/CodeSystem/organization-type\", \"code\": \"prov\", \"display\": \"Healthcare Provider\" }] }]\n}"
            },
            "url": "{{baseUrl}}/Organization/org-acme-salud",
            "description": "Crea/actualiza la organización ACME Salud. Puedes pegar el JSON desde fhir_resources/Organization/org-acme-salud.json"
          }
        },
        {
          "name": "PUT Location (ejemplo Norte)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Accept", "value": "application/fhir+json" },
              { "key": "Content-Type", "value": "application/fhir+json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resourceType\": \"Location\",\n  \"id\": \"loc-norte\",\n  \"identifier\": [{ \"system\": \"http://www.minsalud.gov.co/sedes\", \"value\": \"1100155555-1\" }],\n  \"name\": \"Clínica Norte\",\n  \"status\": \"active\",\n  \"managingOrganization\": { \"reference\": \"Organization/org-acme-salud\" }\n}"
            },
            "url": "{{baseUrl}}/Location/loc-norte",
            "description": "Crea/actualiza la sede Norte. Orden: primero Organization, luego Location."
          }
        }
      ]
    }
  ]
}
